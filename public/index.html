<!DOCTYPE html>
<html>
<head>
  <title>UNO Online</title>
  <style>
    body { font-family: Arial, sans-serif; }
    li { margin: 4px 0; }
  </style>
</head>
<body>

  <h1>UNO Online</h1>

  <!-- Join -->
  <input id="name" placeholder="Your name" />
  <input id="room" placeholder="Room code" />
  <button id="joinBtn" onclick="join()">Join Room</button>

  <!-- Host -->
  <button id="startBtn" onclick="startGame()" style="display:none;">
    Start Game
  </button>

  <!-- Players -->
  <h3>Players:</h3>
  <ul id="players"></ul>

  <!-- Discard pile -->
  <h3>Discard Pile (Top Card):</h3>
  <p id="discard">Waitingâ€¦</p>

  <!-- Hand -->
  <h3>Your Cards:</h3>
  <ul id="hand"></ul>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    let currentRoom = "";
    let myId = "";

    socket.on("connect", () => {
      myId = socket.id;
    });

    // Alerts
    socket.on("alreadyJoined", () => alert("You already joined this room."));
    socket.on("roomFull", () => alert("Room is full."));
    socket.on("notEnoughPlayers", () => alert("Need at least 2 players."));
    socket.on("gameAlreadyStarted", () => alert("Game already started."));

    socket.on("gameStarted", () => {
      alert("Game Started!");
      document.getElementById("startBtn").style.display = "none";
      document.getElementById("joinBtn").style.display = "none";
      document.getElementById("name").disabled = true;
      document.getElementById("room").disabled = true;
    });

    // Player list
    socket.on("playerList", (players) => {
      const ul = document.getElementById("players");
      ul.innerHTML = "";

      let amHost = false;

      players.forEach(p => {
        const li = document.createElement("li");
        li.innerText = p.name + (p.host ? " (Host)" : "");
        ul.appendChild(li);

        if (p.id === myId && p.host) amHost = true;
      });

      const startBtn = document.getElementById("startBtn");
      startBtn.style.display = amHost ? "block" : "none";
      startBtn.disabled = players.length < 2;
    });

    // Hand
    socket.on("yourHand", (hand) => {
      const ul = document.getElementById("hand");
      ul.innerHTML = "";

      hand.forEach(card => {
        const li = document.createElement("li");
        li.innerText = `${card.color.toUpperCase()} ${card.value.toUpperCase()}`;
        ul.appendChild(li);
      });
    });

    // Discard pile
    socket.on("firstCard", (card) => {
      document.getElementById("discard").innerText =
        card.color.toUpperCase() + " " + card.value.toUpperCase();
    });

    socket.on("gameState", (state) => {
      if (state.topCard) {
        document.getElementById("discard").innerText =
          state.topCard.color.toUpperCase() + " " + state.topCard.value.toUpperCase();
      }
    });

    // Actions
    function join() {
      const name = document.getElementById("name").value;
      const room = document.getElementById("room").value;
      if (!name || !room) return;

      currentRoom = room;
      socket.emit("joinRoom", room, name);
      document.getElementById("joinBtn").style.display = "none";
    }

    function startGame() {
      socket.emit("startGame", currentRoom);
    }
  </script>

</body>
</html>
